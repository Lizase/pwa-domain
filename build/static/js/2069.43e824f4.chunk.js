"use strict";(self.webpackChunkqc_app=self.webpackChunkqc_app||[]).push([[2069],{2069:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var s=n(5043);const r={container:"Recommendation_container__gbESl",video:"Recommendation_video__W-in9",video__wrapper:"Recommendation_video__wrapper__QaBfo",video__player:"Recommendation_video__player__34EPx",video__controls:"Recommendation_video__controls__uf3nF",show:"Recommendation_show__xaibs",hide:"Recommendation_hide__rgFl0","fa-icon":"Recommendation_fa-icon__ZhROD",iconWrapper:"Recommendation_iconWrapper__oAXYF",description:"Recommendation_description__oUEhS",tags:"Recommendation_tags__sF-eV",scaleIn:"Recommendation_scaleIn__06Wq7"};var i=n(4117),a=n(6448),o=n(3910),c=n(7929),d=n(3216),l=n(3003),u=n(4477),m=n(497),p=n(3664),v=n(6222),_=n(572),h=n(579);const g=e=>{let{tags:t}=e;const n=(0,d.Zp)(),s=(0,l.d4)((e=>e.init.language));return(0,h.jsx)("div",{className:"flex-wrap flex items-end space-x-2 space-y-2",children:t.map(((e,t)=>(0,h.jsx)("span",{className:"bg-background rounded-full text-primary-active text-xs p-2 cursor-pointer",onClick:()=>{return t=e.tag_name,void n("/app/search",{state:{kw:t}});var t},children:(0,v.iz)(e,s)},t)))})},x=e=>{let{reference:t,id:n,msIds:u,title:p,uuid:x,description:f,tags:b,index:j,currentIndex:N,setCurrentIndex:w,hasInteracted:y}=e;const{t:I}=(0,i.Bd)(),[R,k]=(0,s.useState)(!0),[E,C]=(0,s.useState)(!1),[S,$]=(0,s.useState)(!1),[q,B]=(0,s.useState)(!1),A=(0,s.useRef)(null),W=(0,s.useRef)(null),F=(0,l.wA)();A.current;(0,s.useEffect)((()=>{const e=A.current;e&&(j===N?y&&q?(e.muted=!1,e.play().catch((e=>{console.warn("\u64ad\u653e\u5931\u6557\uff08\u53d6\u6d88\u975c\u97f3\uff09:",e)}))):(e.muted=!0,e.play().catch((e=>{console.warn("\u64ad\u653e\u5931\u6557\uff08\u975c\u97f3\u64ad\u653e\uff09:",e)}))):e.pause())}),[N,q,y]);const Z=(0,l.d4)((e=>e.init.language)),D=(0,d.Zp)();return(0,s.useEffect)((()=>{if(!W.current)return;const e=new IntersectionObserver((e=>{e[0].isIntersecting&&w(j)}),{threshold:.5,rootMargin:"100px"});return e.observe(W.current),()=>{W.current&&e.unobserve(W.current)}}),[]),(0,h.jsxs)("div",{className:r.video,ref:W,children:[(0,h.jsx)("div",{className:"text-orange-200 text-xl self-start m-4 bg-red-500 p-2 rounded-lg",children:t}),(0,h.jsxs)("div",{className:`${r.video__wrapper} aspect-[1.49]`,onClick:()=>{k((e=>{var t,n;e?null===(t=A.current)||void 0===t||t.pause():null===(n=A.current)||void 0===n||n.play();return!e})),$(!0),setTimeout((()=>$(!1)),500)},children:[(0,h.jsx)("div",{className:`${r.video__placeholder}`,style:{display:q?"none":"block",width:"100%"},children:(0,h.jsx)("img",{src:m,className:"w-full h-full object-cover"})}),(0,h.jsx)("video",{className:`${r.video__player} ${q&&j===N?"":"hidden"} w-full h-full object-cover`,ref:A,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,onLoadedData:()=>B(!0),children:x&&j===N&&(0,h.jsx)("source",{src:`https://iqqtv.net/subpage/getMvPreview.php?uuid=${x}`,type:"video/mp4"})}),(0,h.jsx)("div",{className:`${r.video__controls} ${S?r.show:r.hide}`,children:(0,h.jsx)(o.g,{icon:R?c.G1Y:c.ijD})})]}),(0,h.jsxs)("div",{className:"m-4 space-y-4",children:[(0,h.jsx)("p",{className:`text-sm text-gray-300 ${r.description}`,children:f}),(0,h.jsx)("div",{className:r.tags,children:(0,h.jsx)(g,{tags:b})}),(0,h.jsx)(a.A,{className:`${(0,v.kW)(Z)} button-full active py-3`,onClick:()=>{F((0,_.HI)("video")),F((0,_.q9)("video")),D(`/app/Video?uuid=${x}`)},children:I("\u89c0\u770b\u5b8c\u6574\u5f71\u7247")})]})]})},f=()=>{const{t:e}=(0,i.Bd)(),[t,n]=(0,s.useState)(!0),[a,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(0),m=(0,l.wA)(),_=(0,l.d4)((e=>e.video.recommend)),[g,f]=(0,s.useState)([]),b=(0,s.useRef)(null),j=(0,v.rV)(),N=(0,l.d4)((e=>e.init.language));return(0,s.useEffect)((()=>{const e={s_type:"event",s_tid:"17",num:Number(j)};m((0,u.hB)(e))}),[m]),(0,s.useEffect)((()=>{_&&(Number(_.pageNum)===j?f(null===_||void 0===_?void 0:_.products):f((e=>[...e,...null===_||void 0===_?void 0:_.products])))}),[_]),(0,s.useEffect)((()=>{0!==g.length&&n(!1)}),[g]),(0,s.useEffect)((()=>()=>{n(!0),m((0,u.BZ)(null)),f([])}),[]),(0,s.useEffect)((()=>{if(!b.current)return;const e=new IntersectionObserver((e=>{e[0].isIntersecting&&(()=>{const e={s_type:"event",s_tid:"17",num:Number(null===_||void 0===_?void 0:_.pageNum)+1};m((0,u.hB)(e))})()}),{root:document.getElementById("recommendationContainer"),threshold:.5});return e.observe(b.current),Number(null===_||void 0===_?void 0:_.pageNum)===Number(null===_||void 0===_?void 0:_.pageTotals)&&e.unobserve(b.current),()=>{b.current&&e.unobserve(b.current)}}),[_]),(0,h.jsx)("div",{children:t?(0,h.jsx)("div",{children:(0,h.jsx)(p.A,{})}):(0,h.jsxs)("div",{className:r.container,id:"recommendationContainer",onClick:()=>o(!0),children:[g.map(((e,t)=>{var n;return(0,h.jsx)(x,{reference:e.barcode,title:e.name,description:(0,v.iz)(e,N),tags:e.tag_ids,id:e.product_id,msIds:e.ms_ids,uuid:e.uuid,index:t,length:g.length,pageNum:null!==(n=null===_||void 0===_?void 0:_.pageNum)&&void 0!==n?n:j,currentIndex:c,setCurrentIndex:d,hasInteracted:a},t)})),(0,h.jsx)("div",{ref:b,className:"observer-target h-8"})]})})}},497:(e,t,n)=>{e.exports=n.p+"static/media/qc-default-img.e8a429dee9583eb8591b.jpg"}}]);
//# sourceMappingURL=2069.43e824f4.chunk.js.map